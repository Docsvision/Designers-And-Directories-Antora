= Настройка XSLT-преобразований для экспорта

Для пользовательских видов карточки _Документ_ могут быть настроены XSLT-преобразования, позволяющие создать XML-документ с требуемым форматированием.

[NOTE]
====
XSLT-преобразования должны быть созданы заранее, вне системы {dv}.
====

Настроенные варианты экспорта будут доступны в главном меню карточки, при выполнении операции *Отправка*.

[#add-xslt]
== Добавить XSLT-преобразование

.Чтобы добавить XSLT-преобразование:
. xref:card-kinds/select-type.adoc[Выберите] базовый тип карточки _Документ_.
. Выберите в _Дереве видов карточек_ дочерний вид.
. Перейдите на вкладку _Экспорт_.
. Нажмите на кнопку image:buttons/plus-green.png[Зелёный плюс] *Добавить*, чтобы открыть окно _Преобразование_, включающее область редактора XSLT.
+
.Окно "Преобразование"
image::xslt-window.png[Окно "Преобразование"]
+
. Нажмите на кнопку *Загрузить из файла* и выберите файл для открытия в редакторе XSLT.
+
Код из указанного файла будет отображен в области _Редактор_.
+
.Отображение кода XSLT-преобразования в окне "Преобразование"
image::xslt-code.png[Отображение кода XSLT-преобразования в окне "Преобразование"]
+
. В поле _Описание_ введите краткое описание преобразования.
. В поле _Иконка_ добавьте иконку для визуальной идентификации преобразования.
. В поле _Редактор_ отредактируйте код XSLT.
+
XSL-код может содержать переменные (например, для ссылки на файл, который был приложен к исходной карточке).
+
. В поле _Имя переменной ссылки_ укажите ссылки на файлы, которые в процессе преобразования должны быть вставлены в целевой документ вместо переменной.
. После завершения редактирования нажмите на кнопку *ОК*.
+
Добавленное преобразование появится в области _Преобразования_ вкладки _Экспорт_.
+
.Отображение доступных преобразований на вкладке "Экспорт"
image::xslt-list.png[Отображение доступных преобразований на вкладке "Экспорт"]
+
[#sending]
Список добавленных преобразований будет доступен в диалоге, который открывается из главного меню карточки _Документ_ при нажатии на кнопку *Отправка*.
+
.Отображение списка добавленных преобразований в карточке
image::xslt-in-card.png[Отображение списка добавленных преобразований в карточке]

[#edit-xslt]
== Изменить XSLT-преобразование

.Чтобы изменить добавленное ранее XSLT-преобразование:
. xref:card-kinds/select-type.adoc[Выберите] базовый тип карточки _Документ_.
. Выберите в _Дереве видов карточек_ дочерний вид.
. Перейдите на вкладку _Экспорт_.
. Выберите из списка запись о преобразовании, которую требуется изменить.
. Нажмите на кнопку image:buttons/pencil-green.png[Зелёный карандаш] *Изменить*, чтобы <<add-xslt,открыть>> окно _Преобразование_, предназначенное для работы с редактором XSLT.
+
. Внесите необходимые изменения.
. Нажмите на кнопку *ОК*.

[#delete-xslt]
== Удалить XSLT-преобразование

.Чтобы удалить добавленное ранее XSLT-преобразование:
. xref:card-kinds/select-type.adoc[Выберите] базовый тип карточки _Документ_.
. Выберите в _Дереве видов карточек_ дочерний вид.
. Перейдите на вкладку _Экспорт_.
. Выберите из списка преобразование, которое требуется удалить.
. Нажмите на кнопку image:buttons/x-red.png[Красный крестик] *Удалить*.
+
Запись о преобразовании будет удалена из списка вкладки _Экспорт_ и из списка поля _Преобразование_ окна <<sending,Отправка>>.
