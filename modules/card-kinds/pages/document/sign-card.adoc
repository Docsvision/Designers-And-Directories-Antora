= Настройка подписания карточки документа

Подписание документа в системе предназначено в основном для сценариев, когда с документами работают несоклько сотрудников.

Например, подписание используется для уведомления участников согласования о принятых решениях. В карточках библиотеки _{bo}_ для настроенных атрибутов подписания документа предусмотрена цветовая "подсветка" соответствующих полей. Таким образом, остальные подписанты и лица, работающие с документом, могут оценить валидность наложенной подписи.

.Цветовая "подсветка" подписанности предусмотрена только для атрибутов следующих элементов управления:
* xref:layouts/std-ctrl/card.adoc[Карточка].
* xref:layouts/std-ctrl/yes-no.adoc[Да/Нет].
* xref:layouts/std-ctrl/list.adoc[Список].
* xref:layouts/std-ctrl/date-picker.adoc[Дата].
* xref:layouts/std-ctrl/employee.adoc[Сотрудник], но только в варианте выбора одного сотрудника.
* xref:layouts/std-ctrl/section-field.adoc[Поле секции].
* xref:layouts/std-ctrl/number.adoc[Число].
* xref:layouts/std-ctrl/choose-folder.adoc[Выбор папки].
* xref:layouts/std-ctrl/whole-number.adoc[Целое число].
* xref:layouts/std-ctrl/text.adoc[Текст].
* xref:layouts/std-ctrl/numerator.adoc[Нумератор].
* xref:layouts/std-ctrl/value-from-directory.adoc[Значение из справочника].
* xref:layouts/std-ctrl/textbox.adoc[Строка].
* xref:layouts/std-ctrl/time.adoc[Время].
* xref:layouts/std-ctrl/directory-designer-row.adoc[Строка конструктора справочников].

Другие элементы управления не предоставляют функциональности цветовой "подсветки" подписанности атрибута карточки.

Чтобы просмотреть все наложенные на документ подписи, а также сведения о сроках их действительности, предназначен журнал подписей. Тип журнала соответствует типу подписи.

[#sign-additional]
== Подписание дополнительных файлов

Электронная подпись может добавляться не только к _Основным_, но и к _Дополнительным_ файлам карточки.

.Чтобы настроить подписание _Дополнительных_ файлов карточки:
. xref:card-kinds/select-type.adoc[Выберите] базовый тип карточки _Документ_.
. Выберите в _Дереве видов карточек_ дочерний вид.
. Перейдите на вкладку _Подпись_.
+
.Вкладка "Подпись"
image::signature-tab-doc.png[Вкладка "Подпись"]
+
. Установите флаг `*Подписывать дополнительные файлы*`.

[#warning]
== Предупреждения об изменении подписанного файла и атрибута

Для пользовательских видов карточек можно настроить вывод подсказок при изменении подписанного основного файла/атрибута документа. Для файла -- при сохранении файла, для атрибутов -- при сохранении карточки.

.Чтобы настроить предупреждения об изменении подписанного файла и атрибута:
. Перейдите на вкладку _Подпись_.
. Установите флаг `*Предупреждение об изменении подписанного файла или атрибута*`.
+
По умолчанию флаг установлен.
+
* При изменении файла будет появляться сообщение: `Данный документ подписан цифровой подписью, при изменении файла подпись будет недействительна. Сохранить изменения файла?`.
* При сохранении карточки будет появляться сообщение: `Атрибут подписан цифровой подписью. При изменении атрибута, подпись будет недействительна. Сохранить изменения?`.

[#attorney]
== Использовать МЧД при подписании

Определяет необходимость использования МЧД при подписании данного вида документов.

.Для вида карточки доступны три варианта необходимости использования МЧД
* *_Не требуется_* -- значение по умолчанию
* *_Желательно_*
* *_Обязательно_*

При подписании документа выполняется проверка необходимости МЧД для вида документа. В зависимости от выбранного значения в поле _Использовать машиночитаемую доверенность при подписании_, алгоритм подбора МЧД выполняет или пропускает поиск доверенностей.

* Если значение поля *_Обязательно_* или *_Желательно_*, сразу начинается _Проверка необходимости МЧД для подписанта_.
* Если значение поля *_Не требуется_*, то процесс подбора завершается, МЧД не требуется, дальнейшие операции не выполняются.

[#signature-attribute]
== Добавить атрибут подписи

При настройке подписи для пользовательских видов карточек можно настроить поля, которые должны быть подписаны. Данные поля будут считаться атрибутами подписи.

.Чтобы добавить в подпись атрибуты:
. xref:card-kinds/select-type.adoc[Выберите] базовый тип карточки _Документ_.
. Выберите в _Дереве видов карточек_ дочерний вид.
. Перейдите на вкладку _Подпись_.
. Найдите область _Атрибуты подписи_.
. Нажмите на кнопку image:buttons/plus-green.png[Зелёный плюс], чтобы открыть окно выбора поля.
+
.Выбор поля для подписания
image::select-sync-field.png[Выбор поля для подписания]
+
. Выберите названия полей карточки, которые требуется подписывать.
+
[WARNING]
====
В качестве атрибутов нельзя выбрать поля с типом _Таблица_.
====
+
. Нажмите кнопку *ОК*.

[#delete-attribute]
== Удалить атрибут подписи

.Чтобы удалить атрибут подписи:
. Перейдите на вкладку _Подпись_.
. Найдите область _Атрибуты подписи_.
. Выберите атрибут, который требуется удалить.
. Нажмите на кнопку image:buttons/x-red.png[Красный крестик].
+
Атрибут будет удалён.

== Добавить метку подписи

В поставляемой версии системы {dv} уже имеется ряд настроенных меток (см. раздел xref:signatures/directory.adoc[Справочник меток подписей]), которые могут использоваться для подписания карточек.

.К таким меткам относятся:
* _Согласовано_.
* _Не согласовано_.
* _Утверждено_.
* _Не Утверждено_.
* _Подписано_.
* _Не подписано_.
* _Ознакомлен_.

.Чтобы добавить метку подписи:
. Перейдите на вкладку _Подпись_.
. Найдите область _Доступные метки_.
. Нажмите на кнопку image:buttons/plus-green.png[Зелёный плюс] *Добавить метку*.
+
Будет открыто окно для добавления метки подписи.
+
.Выбор метки подписи
image::select-label.png[Выбор метки подписи]
+
. Выделите нужную метку.
. Нажмите на кнопку image:buttons/check.png[Зелёная галочка].

[#delete-label]
== Удалить метку подписи

.Чтобы удалить метку подписи:
. Перейдите на вкладку _Подпись_.
. Найдите область _Доступные метки_.
. Удалите метку нажатием кнопки image:buttons/x-red.png[Красный крестик].
