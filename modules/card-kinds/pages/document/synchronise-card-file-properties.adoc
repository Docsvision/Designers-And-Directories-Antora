= Настройка синхронизации свойств карточки и файла

Для документов в формате Microsoft Office в системе {dv} имеется ряд дополнительных возможностей. В частности, при вложении файлов формата Microsoft Office в карточку _Документ_ пользовательского вида, допускается копирование свойств файла в карточку и свойств карточки в файл.

Данная операция в рамках системы {dv} называется _Синхронизация свойств полей_.

[WARNING]
====
Настройка синхронизации поддерживается только для _основных_ файлов карточки.
====

Для файлов Microsoft Office работа с синхронизируемыми полями осуществляется в окне _Свойства_.

.Свойства документа Microsoft Word 2010
image::word-doc-properties.png[Свойства документа Microsoft Word 2010]

Чтобы настроить синхронизацию полей, в файле необходимо указать префикс для свойства (`@`). Если нужные свойства в файле отсутствуют, они будут созданы автоматически.

include::partial$excerpts.adoc[tags=name-rules]

Если синхронизация настроена в обе стороны ("в карточку" и "из карточки"), при сохранении производится проверка произведенных изменений. При изменении и сохранении значения поля в карточке, будет изменено значение в файле, и наоборот.

[#select-sync]
== Выбрать синхронизируемое поле карточки {dv}

В качестве синхронизируемого поля может быть указано любое доступное поле карточки _Документ_, за исключением полей табличных секций и секции "Системные свойства" -- поля данных секций не синхронизируются.

.Чтобы выбрать синхронизируемое поле карточки:
. xref:card-kinds/select-type.adoc[Выберите] базовый тип карточки _Документ_.
. Выберите в _Дереве видов карточек_ дочерний вид.
. Перейдите на вкладку _Свойства_.
. Нажмите на кнопку image:buttons/table-wtih-plus.png[Таблица с плюсом] *Создать*, чтобы открыть окно для выбора поля карточки _Документ_.
+
.Выбор синхронизируемого поля карточки
image::select-sync-field.png[Выбор синхронизируемого поля карточки]
+
. Выберите название поля.
. Нажмите на кнопку *ОК*.
. Настройте <<sync-props,свойства>> синхронизируемого поля.

[#card-to-file]
== Копирование свойства "из карточки" в файл

include::5.5.17@webclient:user:partial$excerpts.adoc[tags=sync-fields]

.Чтобы настроить копирование данных из карточки "Документ" в файл:
. <<select-sync,Выберите>> поле карточки _Документ_, значение которого должно быть скопировано в свойства файла.
. <<sync-props,Настройте>> свойство синхронизации:
+
.. Введите название свойства.
.. Выберите способ синхронизации *_Из карточки_*.
+
.Пример настройки свойства для копирования данных из карточки
image::card-to-file-sync.png[Пример настройки свойства для копирования данных из карточки]
+
. Создайте карточку данного пользовательского вида, и вложите в карточку файл формата Microsoft Office.
. Сохраните карточку, чтобы изменить вложенный в карточку файл.
. Откройте вложенный файл из интерфейса карточки.
+
Данные, записанные в _Поле_ свойства окна _Настройки свойства_ будут отображены в окне свойств файла Microsoft Office на вкладке.
+
.Пример отображения данных поля в Microsoft Office
image::card-to-file-office.png[Пример отображения данных поля в Microsoft Office]
+
include::partial$excerpts.adoc[tags=name-rules]

[#file-to-card]
== Копирование свойства из файла "в карточку"

.Чтобы настроить копирование данных из поля файла в карточку _Документ_:
. <<select-sync,Выберите>> поле карточки _Документ_, в которое должно быть скопировано настроенное свойство файла.
. <<sync-props,Настройте>> свойство синхронизации:
+
.. Введите название свойства.
.. Выберите способ синхронизации _В карточку_.
+
.Пример настройки свойства для копирования данных в карточку
image::card-to-file-synched.png[Пример настройки свойства для копирования данных в карточку]
+
. Откройте приложение Microsoft Office и создайте файл Microsoft Office.
. Откройте окно свойств файла.
. На вкладке добавьте новое свойства поля файла.
+
include::partial$excerpts.adoc[tags=name-rules]
+
Свойство будет отображено в области *Properties/Свойства*.
+
.Пример настройки свойств поля файла Microsoft Office
image::file-to-card-office.png[Пример настройки свойств поля файла Microsoft Office]
+
. Создайте карточку данного пользовательского вида, и вложите в карточку файл формата Microsoft Office.
+
Поле карточки будет заполнено в момент вложения в карточку _Основного_ файла.

[#sync-props]
== Свойства синхронизируемого поля

Когда будет определено синхронизируемое поле карточки {dv}, необходимо настроить способ синхронизации данного поля с файлом Microsoft Office.

.Чтобы настроить способ синхронизации:
. <<select-sync,Выберите>> поле, свойства которого требуется настроить.
. Нажмите на кнопку image:buttons/edit.png[Редактировать] *Изменить*, чтобы открыть окно настроек свойств поля.
+
.Настройка свойств поля
image::property-settings.png[Настройка свойств поля]
+
. При необходимости в поле _Название_ введите название свойства синхронизации.
. В поле _Направление_ укажите направление копирования значений полей:
* Для копирования значений из карточки в файл выберите вариант _Из карточки_.
* Для копирования значений из файла в карточку выберите вариант _В карточку_.
+
По умолчанию включены оба направления. Диалог настройки дополнений также может изменять и сам тип параметра.
+
. При необходимости в поле _Поле_ выберите поле карточки _Документ_, которое должно синхронизироваться со свойствами файла Microsoft Office.
. Нажмите на кнопку *Принять*.
+
Свойства поля будут изменены.

[#delete-sync]
== Удалить синхронизируемое поле карточки

.Чтобы удалить синхронизируемое поле карточки:
. xref:card-kinds/select-type.adoc[Выберите] базовый тип карточки _Документ_.
. Выберите в _Дереве видов карточек_ дочерний вид.
. Перейдите на вкладку _Свойства_.
. Выберите поле, свойства которого требуется настроить.
. Нажмите на кнопку image:buttons/x-red.png[Красный крестик].
+
Поле будет удалено.
