= Конструктор разметок

_Конструктор разметок_ предназначен для изменения внешнего вида карточек.

С помощью xref:layouts/designer.adoc["Конструктора разметок"] для выбранного вида карточки можно настроить свойства существующих элементов управления, а также добавлять новые, редактировать их размер и менять взаимное расположение.

Разметка может быть создана или изменена для любого вида, который работает со своими собственными настройками, см. раздел xref:card-kinds/general-inherit.adoc[].

Каждому виду карточки обязательно должна соответствовать как минимум одна разметка, которая может быть привязана к определённому состоянию или роли.

[#interface]
== Интерфейс Конструктора разметок

.Главное окно (карточка) _Конструктора разметок_ состоит из следующих областей:
* <<designs,Область "Дерево дизайнов">> -- предназначена для отображения списка доступных разметок карточки.
* <<list,Область "Список разметок">> -- предназначена для просмотра списка разметок, созданных для выбранного типа или вида карточки.
* <<layouts,Область "Разметки">> -- предназначена для визуального отображения разметки, выбранной в области _Дерево дизайнов_.
* <<toolbar,Область "Панель инструментов">> -- предназначена для отображения xref:layouts/controls-settings.adoc[элементов управления].
* <<structure,Область "Структура разметки">> -- предназначена для просмотра структуры элементов будущей карточки, а также для управления элементами выбранной разметки.

Области окна могут быть скрыты или отображены в зависимости от предпочтений пользователя.

.Конструктор разметок
image::layouts-designer.png[Конструктор разметок]

[#ribbon]
=== Лента

.Лента Конструктора разметок содержит:
* Поля для выбора библиотеки и вида карточки.
* Поле для выбора локализации.
* Команды, список которых представлен в таблице ниже.

.Команды на ленте Конструктора разметок
[cols="10%,20%,70",options="header"]
|===
|Кнопка |Название |Назначение

|image:buttons/save.png[Сохранить]
|Сохранить
|Сохраняет изменения для текущего вида.

|image:buttons/ribbon-settings.png[Настройка ленты]
|xref:layouts/ribbon-settings.adoc[Настройка ленты]
|Вызывает дополнительное окно настройки ленты выбранной разметки для карточек текущего вида.

|image:buttons/edit-metadata.png[Редактировать метаданные]
|xref:layouts/edit-extended-metadata.adoc[Редактирование динамических метаданных]
|Позволяет управлять пользовательскими полями.

|image:buttons/ctrl-button.png[Клавиша CTRL]
|xref:layouts/hotkeys.adoc[Настройка сочетаний клавиш]
|Позволяет задать комбинации клавиш для часто используемых операций, выполняемых в конструкторе.

|image:buttons/globe.png[Земной шар]
|xref:layouts/layout-localize.adoc#add-locale[Редактирование списка локализаций]
|Позволяет добавить и изменить локализацию разметки.

|image:buttons/unlocked-blue-fill.png[Синий замок открыт] / image:buttons/locked-green-fill.png[Зелёный замок закрыт]
|xref:layouts/lock-kind.adoc[Блокировка или разблокировка вида для редактирования]
|Изменяет текущее состояние блокировки редактирования разметок выбранного вида карточек.
|===

[#designs]
=== Область "Дерево дизайнов"

Для управления выбором разметки при открытии карточки служит _Дерево дизайнов_.

Здесь отображается дерево условий, по которым выбирается разметка для карточки.

.Дерево дизайнов
image::design-tree-area.png[Дерево дизайнов]

Управление узлами дерева осуществляется при помощи кнопок, размещенных в данной области.

.Команды в области "Дерева дизайнов"
[cols="10%,20%,70",options="header"]
|===
|Кнопка |Название |Назначение

|image:buttons/new-node.png[Новый узел]
|Новый узел
|Создаёт новый узел в дереве. Данная кнопка будет неактивна, если выделена разметка.

|image:buttons/delete-node.png[Удалить узел]
|Удалить узел
|Удаляет ранее созданный узел. Корневой узел удалить нельзя.

|image:buttons/node-higher.png[Повысить узел]
|Переместить выше
|Сдвигает выделенный элемент дерева на одну позицию вверх.

|image:buttons/node-lower.png[Понизить узел]
|Переместить ниже
|Сдвигает выделенный элемент дерева на одну позицию вниз.
|===

Кнопки image:buttons/node-higher.png[Повысить узел] *Переместить выше* и image:buttons/node-lower.png[Понизить узел] *Переместить ниже* активны для узлов одинакового типа в рамках одной ветки. Если узел типа _Состояние_ один в текущей ветке дерева, то его переместить нельзя.

[#list]
=== Область "Список разметок"

Для отображения созданных разметок предназначена область _Список разметок_.

.Панель "Список разметок"
image::layouts-list.png[Панель "Список разметок"]

Управление разметками осуществляется при помощи кнопок, размещенных в данной области.

.Команды в области "Списка разметок"
[cols="10%,20%,70",options="header"]
|===
|Кнопка |Название |Назначение

|image:buttons/plus-squared.png[Плюс в квадрате]
|Добавить разметку
|Создаёт новую разметку в списке.

|image:buttons/x-red-squared.png[Крестик в квадрате]
|Удалить разметку
|Удаляет выбранную разметку из списка. Если разметка задействована в _Дереве дизайнов_, её удаление будет запрещено. Для выполнения данной операции необходимо сначала удалить разметку из дерева, и только затем -- из списка разметок.

|image:buttons/two-squares.png[Два квадрата]
|Копировать разметку из другого вида
|Выводит диалог выбора пользовательских видов, доступных для выбранного типа карточки. Из выбранного вида можно скопировать разметку.

|image:buttons/pencil-green.png[Карандаш]
|Переименовать разметку
|Позволяет изменить название разметки.
|===

[#layouts]
=== Область "Разметки"

Панель _Разметки_ отображает текущую разметку карточки в режиме редактирования. На данной панели осуществляется настройка разметки карточки: определяется набор доступных элементов, их местоположение, размеры и группировка.

.Панель "Разметки"
image::layouts-panel.png[Панель "Разметки"]

[#toolbar]
=== Область "Панель инструментов"

Область _Панель инструментов_ служит для добавления новых xref:layouts/controls-settings.adoc[элементов управления] в разметку карточки.

.Область "Панель инструментов"
image::toolbar.png[Область "Панель инструментов"]

Местоположение элемента в дальнейшем можно изменить, но рекомендуется сразу размещать элемент управления как можно ближе к желаемому месту на разметке. Это значительно упростит дальнейшую настройку разметки.

[#structure]
=== Область "Структура разметки"

Область _Структура разметки_ отображает в виде дерева структуру текущей разметки.

Корневым узлом является сам элемент управления карточки, далее в соответствии с группировками отображаются дочерние элементы. При выборе элемента в дереве, он выделяется в области _Разметки_.

Выбрать элемент управления карточки можно только с помощью структуры разметки (для этого необходимо выбрать корневой элемент).

.Область "Структура разметки"
image::layout-structure.png[Область "Структура разметки"]

[#work]
== Работа с конструктором

_Конструктор разметок_ позволяет не только вносить изменения в разметки, входящие в комплект поставки решения, но и создавать собственные пользовательские разметки.

Новые разметки можно создавать только для пользовательских видов карточек. Изменять разметки базовых типов карточек запрещено. Соответственно, для работы с конструктором виды должны быть заранее созданы в _Справочнике видов карточек_. Для пользовательского вида должен быть настроен способ наследования разметок базового типа.

Как правило, новые разметки создаются для определённых пользовательских ролей и состояний карточек. Соответственно, для полноценной работы с конструктором, роли и состояния должны быть заранее настроены.

.Обычно работа с конструктором выполняется по следующему принципу:
. Определяется базовый тип карточки, на основании которого следует создать собственное решение.
. Для данного типа в _Справочнике видов карточки_ создаётся пользовательский вид. Данный вид xref:layouts/select-card-kind.adoc[открывается] для редактирования в _Конструкторе разметок_.
. При помощи инструмента конструктора xref:layouts/work-with-layouts.adoc[Список разметок] создаётся набор разметок различного назначения.
. Каждая из созданных разметок дополняется или изменяется путем добавления соответствующих xref:layouts/controls-settings.adoc[элементов управления] из числа доступных в области xref:layouts/designer.adoc#toolbar["Панель инструментов"]. При необходимости создаются пользовательские xref:layouts/edit-extended-metadata.adoc[расширенные поля], которые затем добавляются в карточку.
. Выполняется xref:layouts/layout-settings.adoc[настройка разметки]: для добавленных элементов настраивается способ размещения, определяются общие и индивидуальные свойства, выполняется настройка xref:layouts/ribbon-settings.adoc[ленты] и xref:layouts/hotkeys.adoc[сочетания клавиш].
. Настроенные разметки привязываются к ролям и состояниям карточки при помощи инструмента xref:layouts/design-tree.adoc["Дерево дизайнов"].
