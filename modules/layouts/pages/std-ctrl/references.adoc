= Ссылки

Не путать с элементом xref:layouts/hc-ctrl/links.adoc[].

== Назначение

Элемент предназначен для создания таблицы ссылок на другие элементы (карточки, файлы и т.д.). Работает со _Справочником ссылок_.

Ссылки можно создавать в _Справочнике ссылок_. Имена ссылок могут быть произвольными.

== Отображение в области "Панель инструментов"

.Ссылки в области "Панель инструментов"
image::references-control.png[Ссылки в области "Панель инструментов"]

== Отображение в запущенной карточке

Возможно использование двух режимов отображения: *Карточки* и *Файлы*.

=== Режим "Файлы"

.Режим "Файлы"
image::references-mode-files.png[Режим "Файлы"]

В режиме *Файлы* заблокированные и разблокированные файлы различаются иконками.

.Пользователям доступны операции:
* _Добавить файл_ -- открывает окно для добавления файла, с выбором вида создаваемой карточки _Документ_.
* _Отсканировать и добавить_ -- после выбора вида будущей карточки будет показан диалог сканирования. Отсканированный файл будет приложен к созданной карточке документа выбранного ранее вида как _основной_. В описываемом элементе `_Ссылки_` будет отражена связь между карточками.
+
Чтобы команда отобразилась в меню, в свойстве <<operations,Операции>> следует установить флаг `*Сканирование файла*`. Для разграничения доступа к операции с использованием _ролевой модели_, в свойстве <<state-operations,Операции состояния>> в поле _Добавить дополнение_ следует указать доступные операции редактирования.
+
* _Редактировать_ -- открывает файл на редактирование.
* _Открыть_ -- открывает файл на чтение.
* _Открыть карточку_ -- открывает карточку выбранного файла.
* _Удалить_ -- удаляет выбранный файл.
* _Копировать_ -- копирует выбранный файл.
* _Заблокировать для работы_ -- блокирует выбранный файл.
* _Вернуть с блокировки_ -- возвращает открытый файл с блокировки.
* _Отменить блокировку_ -- отменяет блокировку файла.
* _Показать область группировки_ -- в верхней части таблицы будет отображена область для группировки по столбцу.
* _Обновить_ -- обновляет записи в таблице.

=== Режим "Карточки"

.Режим "Карточки"
image::references-mode-cards.png[Режим "Карточки"]

.Пользователям доступны операции:
* _Добавить файл_ -- открывает подменю со списком доступных видов. После выбора вида будет показан диалог выбора файла из файловой системы.
+
Для выбранного файла будет автоматически создана карточка документа (выбранного ранее вида), и эта карточка будет приложена в виде ссылки в описываемый элемент `_Ссылки_`.
+
* _Отсканировать и добавить_ -- после выбора вида будущей карточки будет показан диалог сканирования. Отсканированный файл будет приложен к созданной карточке документа выбранного ранее вида как _основной_. В описываемом элементе `_Ссылки_` будет отражена связь между карточками.
+
Чтобы команда отобразилась в меню, в свойстве <<operations,Операции>> следует установить флаг `*Сканирование файла*`. Для разграничения доступа к операции с использованием _ролевой модели_, в свойстве <<state-operations,Операции состояния>> в поле _Добавить дополнение_ следует указать доступные операции редактирования.
+
* _Создать карточку_ -- создаёт новую карточку выбранного вида, после чего она появится в виде ссылки в описываемом элементе.
* _Добавить карточку_ -- выбирает существующую карточку в системе {dv} и создаёт связи между открытой и добавляемой карточкой. Диалог добавления позволяет выбрать сразу несколько карточек. На выбранные карточки будут созданы ссылки одного типа.
* _Добавить карточку по шаблону_ -- открывает окно навигации по папкам {dv}, в котором будут отображены только шаблоны. После выбора шаблона, на его основе будет создана карточка, которая и будет приложена в виде ссылки.
* _Добавить папку {dv}_ -- добавляет ссылку на выбранную папку {dv}.
* _Добавить URL_ -- добавляет ссылку на веб-страницу, добавленную в текстовом поле:
+
.Добавить URL
image::references-add-url.png[Добавить URL]
+
* _Удалить_ -- удаляет выбранную ссылку.
* _Описание_ -- открывает окно для ввода описания ссылки.
+
.Описание ссылки
image::references-reference-description.png[Описание ссылки]
+
* _Открыть_ -- открывает выбранную карточку, к которой прикреплен файл. Для открытой карточки включается режим блокировки.
* _Копировать_ -- копирует выбранную карточку, добавляет ссылку на копию.
* _Показать область группировки_ -- в верхней части таблицы будет отображена область для группировки по столбцу.
+
.Группировка по типу ссылки
image::references-reference-type-group.png[Группировка по типу ссылки]
+
* _Показать область описания_ -- включает режим отображения описаний, добавленных командой _Описание_.
+
.Режим отображения описаний
image::references-description-display.png[Режим отображения описаний]
+
Если в настройках элемента управления активирован параметр *Показывать описания*, режим отображения описаний будет включен по умолчанию.
+
* _Обновить_ -- обновление записей в таблице.

В контекстном меню элемента реализован механизм, позволяющий вычислять и исключать из меню элементы, которые настройками *Типы карточек* и *Типы ссылок* определены как единственно возможные для выбора.

Например, для создания карточки вида _Внутренний_ вместо переходов: menu:Создать карточку[Тип ссылки > Документ > Документ УД > Внутренний] пользователю будут доступны переходы меню: menu:Создать карточку[Тип ссылки > Внутренний], так как тип _Документ_ и вид _Документ УД_ являются единственными на своем уровне в дереве видов карточек.

.Вычисление исключаемых элементов выполняется по следующим правилам:
* Если для элемента задан единственный тип карточки и несколько типов ссылок, в меню будет отображено: menu:Создать карточку[Тип ссылки], а выбор вида будет пропущен.
* Если для элемента задан единственный тип ссылки и один или несколько видов карточек, в меню будет отображено: menu:Создать карточку[Вид карточки], а выбор типа ссылки будет пропущен.

== Общие

xref:layouts/controls-standard.adoc#common-properties[Общие свойства элементов управления].

== Поведение

Режим отображения::
В поле можно выбрать режим отображения содержимого:
+
* *_Файлы_* -- режим предназначен для работы со ссылками на карточки _Документ_. В данном режиме вложения отображаются в виде списка файлов.
* *_Карточки_* -- режим предназначен для работы со ссылками любых типов. В данном режиме вложения отображаются в виде таблицы карточек.

== Данные

Источник данных::
Тип поля данных -- *_RefcardID_* (поле -- ссылка на системную карточку списка ссылок).
+
.В поле необходимо выбрать источник данных для элемента:
* Для создания карточек заданий из карточки документа указать: _Источник данных_ -- *_Основная информация_*, _Поле данных_ -- *_Ссылки_*.
* Для создания карточки документа из карточки задания указать: _Источник данных_ -- *_Задание_*, _Поле данных_ -- *_Список ссылок_*.
* Для отображения в области вложений карточки _Задания_ ссылок на файлы указать: _Источник данных_ -- *_Задание_*, _Поле данных_ -- *_Список ссылок_*, _Типы ссылок_ -- указать типы ссылок, настроенные в _Справочнике видов карточек_ для вида задания на вкладке _Задание_.
+
[WARNING]
====
Для корректной работы элемента управления, тип ссылки поля, являющегося источником данных, должен быть *_Сильная ссылка_*.
====

[#operations]
Операции::
В поле необходимо выбрать операции, для которых будет доступен выбор ссылки. При этом в контекстном меню элемента появится пункт, соответствующий операции.
+
.Выбор доступных операций для типа ссылки
image::references-operations.png[Выбор доступных операций для типа ссылки]

[#state-operations]
Операции состояния::
Свойство позволяет указать операцию из _Конструктора состояний_ для операций, выбранных из свойства *Операции*.
+
.Операции и состояния элемента разметки
image::references-state-operations.png[Операции и состояния элемента разметки]

Операция редактирования::
В поле можно выбрать операцию из _Конструктора состояний_ для редактирования элемента управления. При запрете операции в конструкторе редактирование элемента `_Ссылки_` также будет запрещено.

Папка по умолчанию::
В поле можно указать папку, которая будет открываться по умолчанию при выборе карточки. Можно выбрать папку любого вида (как обычной, так и виртуальной, в том числе -- с параметрическим поиском).
+
.В зависимости от настроек элемента, в карточке будет выполняться следующий сценарий:
* Если папка указана, при выборе карточки будет открываться данная папка.
* Если папка не указана, будет открываться _Личная_ папка, а при её отсутствии -- дерево папок.

Предпросмотр::
В поле необходимо выбрать элемент типа xref:layouts/std-ctrl/file-preview.adoc[Предпросмотр файла] из элементов, существующих в текущей разметке. При этом в работающем приложении при выделении файла в элементе управления `_Ссылки_` файл будет открыт в режиме предварительного просмотра в связанном элементе `_Предпросмотр файлов_`. Файл отображается, когда значение свойства *Режим отображения* = *_Файлы_*.

Создание без типа ссылки::
В поле определяется возможность добавления файлов и создания карточек без указания типа ссылок:
+
* *_Да_* -- при создании карточки в контекстном меню элемента управления _Ссылки_ будет доступна опция _Ссылка не задана_. Создавать карточки при помощи данного элемента управления можно без указания типа ссылки.
* *_Нет_* -- добавление карточки и создание карточки возможно только с указанием типа ссылки.

Типы карточек::
В поле определяется возможность добавления файлов и создания определённых типов и видов карточек.
+
Для выбранного вида можно автоматически добавлять дочерние виды. Чтобы настроить данную возможность, следует выбрать вид в окне _разрешённые типы и виды_, затем вызвать контекстное меню для этого вида и включить опцию _Включая дочерние_.
+
Контекстное меню появится, когда значение свойства *Режим отображения* = *_Файлы_* и только при наличии флага, установленного напротив требуемого вида. При включении опции _Включая дочерние_, новые создаваемые подчиненные виды автоматически добавляются в элемент управления и становятся доступными для выбора.

Типы ссылок::
В поле определяются допустимые типы ссылок, которые могут использоваться при добавлении файлов.

Хранить сильную ссылку::
В поле можно указать необходимость использования сильных (значение *_Да_*) или слабых ссылок (значение *_Нет_*).

== Внешний вид

Показывать описания::
Определяет видимость описаний к ссылкам:
+
* *_Да_* -- описания по умолчанию отображаются.
* *_Нет_* -- описания по умолчанию скрыты.

== Настройка локализации

Допускается xref:layouts/layout-localize.adoc#localize-general[локализация общих свойств] элемента. Описание настройки локализации содержится в разделе xref:layouts/controls-standard.adoc#common-properties[Общие свойства элементов управления].
